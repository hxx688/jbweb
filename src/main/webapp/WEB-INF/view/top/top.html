<!-- 
 * Generated by Blade.
 * 2017-09-04 21:47:01
 -->
@layout("/common/_container.html"){
	<div  style="margin:20px;border:1px solid #ccc;">
	<form data-url="/blade/top/update" method="post" class="form-horizontal" role="form" novalidate="novalidate">
		<!-- 表单 -->
	<div class="space-4"></div>
			<!-- 判断表单是否发生过更改的token -->
			<input type="hidden" id="form_token" value="0">
			<!-- 乐观锁控制 -->
			<input type="hidden" id="_version" name="VERSION" value="0">
			
				<input type="hidden" id="_id" name="dt_top.id" value="1">
						<div class="form-group" style="display:block">
							<label class="col-sm-2 control-label no-padding-right"> 保证金 </label>			
							<div class="col-sm-8" style="padding-top:5px;">
								<input type="radio" name="dt_top.is_cash" value="0"> 否 
								<input type="radio" name="dt_top.is_cash" value="1" checked="checked"> 是
							</div>
						</div>
	
						<div class="form-group" style="display:block">
							<label class="col-sm-2 control-label no-padding-right"> 是否休盘 </label>			
							<div class="col-sm-8"  style="padding-top:5px;">
								<input type="radio" name="dt_top.is_stop" value="0" checked="checked"> 否 
								<input type="radio" name="dt_top.is_stop" value="1"> 是
							</div>
						</div>
	
						<div class="form-group" style="display:block">
							<label class="col-sm-2 control-label no-padding-right"> 龙虎榜 </label>			
							<div class="col-sm-8">
								<textarea cols="10" rows="10" name="dt_top.top" placeholder="暂无龙虎榜" class="form-control"></textarea>
							</div>
						</div>				
	<div class="space-4"></div>		
		<!-- 按钮 -->
		<div class="clearfix form-actions center" style="margin-top:15px;margin-bottom:5px;">
			<div class="col-md-offset-1 col-md-10">
			  	<button class="btn btn-info" type="submit" id="btn_save">
					<i class="ace-icon fa fa-check bigger-110"></i>
					修改
				</button>

				&nbsp; &nbsp; &nbsp;
				<button class="btn" type="button" id="btn_close">
					<i class="ace-icon fa fa-close bigger-110"></i>
					关闭
				</button>
			</div>
		</div>
		<script src="/blade/static/validate/jquery-html5Validate.js"></script>
		<script type="text/javascript">
			var layerIndex = parent.layer.getFrameIndex(window.name); //获取窗口索引
			
			$(function(){
				$("form").html5Validate(function() {
					/* if($("#form_token").val()==0){
						layer.alert("表单并未修改请勿提交!", {icon: 7,title:"提示"});
						return false;
					} */
					if( typeof saveBefore === 'function' ){
						saveBefore();
			        }
					var appindex = appLoading();
					var $form = $(this);
					
					var ajax = new $ax($form.attr("data-url"), function(data){
						if (data.code === 0) {
							clearLoading(appindex);
							layer.msg(data.message, {shift: 1});
							setTimeout(function(){
								closeTab(true);
							},500);
							return false;
						} else {
							clearLoading(appindex);
							$("#btn_save").removeAttr("disabled","disabled");
							if(data.code===999){
								layer.alert(data.message, {icon: 2,title:"发生错误"});
							}
							else{
								layer.msg(data.message, {shift: 6,time:2000});
							}
							return false;
						}
					});
					ajax.data = $form.serialize();
					ajax.start();
					
					return false;
				}, {
					// novalidate: false
				});
				
				$("#btn_close").bind("click",function(){
					closeTab(("" == "true") ? true : false);
				});
				
				function closeTab(isReload){
					//未找到layerIndex代表为新增tab页
					if(typeof (layerIndex) == "undefined"){
						var tabId = "";
						var dataUrl = $("form").attr("data-url");
						if(typeof (dataUrl) == "undefined"){
							tabId = "btn_top_view_";
						}else if(dataUrl.indexOf("save") > 0){
							tabId = "btn_top_add";
						}else if(dataUrl.indexOf("update") > 0){
							tabId = "btn_top_edit_";
						}else{
							tabId = "btn_top_view_";
						}
						if(isReload){
							window.top.reloadTabById("top")
						}
						window.top.autoClose(tabId,"top");
					} else{
						if(isReload){
							parent.searchGrid();
						}
						parent.layer.close(layerIndex);
					}
				}
				
			});
		</script>	
	</form>
	</div>
@}